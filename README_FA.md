# chagas-ecg-diagnosis

[๐ฌ๐ง Click here for the English README](README.md)

ุชุดุฎุต ุฎูุฏฺฉุงุฑ ุจูุงุฑ ุดุงฺฏุงุณ ุงุฒ ููุงุฑ ููุจ (ECG) 12-ูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุฏฺฏุฑ ฺฏุฑูู (Ensemble Learning) ู ุดุจฺฉูโูุง ุนุตุจ ุนูู (ResNet/Transformers). ุชูุณุนูโุงูุชู ุจุฑุง ูุณุงุจูู PhysioNet 2025.

## ๐ง ุฑูฺฉุฑุฏูุง

### ุงุฏฺฏุฑ ูุงุดู ฺฉูุงุณฺฉ (`team_code_classic_machine_learning.py`)
ุงู ุฑูฺฉุฑุฏ ุจุฑ ูพุงู ูููุฏุณ ูฺฺฏโูุง ุฏุณุช ู ุชุฑฺฉุจ (Ensemble) ุงุฒ ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดู ุณูุช ุงุณุชูุงุฑ ุงุณุช:
- **ุงุณุชุฎุฑุงุฌ ูฺฺฏ:** ุงุณุชุฎุฑุงุฌ ูฺฺฏโูุง ููุฑููููฺฺฉ (ุขูุงุฑุ RMSุ ุนุจูุฑ ุงุฒ ุตูุฑ)ุ ุญูุฒู ูุฑฺฉุงูุณ (PSD ุฏุฑ ุจุงูุฏูุง ูุฎุชูู) ู HRV (ุชุบุฑูพุฐุฑ ุถุฑุจุงู ููุจ / ููุงุตู R-R) ุฏุฑ ุทูู 12 ูุฏ ููุงุฑ ููุจ.
- **ูุชุนุงุฏูโุณุงุฒ ุฏุงุฏูโูุง:** ุฑูุน ุนุฏู ุชุนุงุฏู ฺฉูุงุณโูุง ุงุฒ ุทุฑู ูุฒูโุฏู ูููููโูุง ุจุฑ ุงุณุงุณ ููุจุน ุฏุงุฏู (ฺฉุงูุด ูุฒู ุจุฑฺุณุจโูุง ุถุนู CODE-15%) ู ุงุณุชูุงุฏู ุงุฒ ุฑูุด ูููููโุจุฑุฏุงุฑ ูุฌุฏุฏ SMOTE + ENN.
- **ุฏุณุชูโุจูุฏ ฺฏุฑูู (Ensemble Classifier):** ุชุฑฺฉุจ ุฑุฃโฺฏุฑ ูุฑู (soft-voting) ุดุงูู ุฌูฺฏู ุชุตุงุฏู (Random Forest) (40%)ุ ฺฏุฑุงุฏุงู ุจูุณุชูฺฏ (Gradient Boosting) (40%) ู ุฑฺฏุฑุณูู ูุฌุณุชฺฉ (Logistic Regression) (20%)ุ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ุขุณุชุงูู ุชุตููโฺฏุฑ ุจูููโุดุฏู.

### ุดุจฺฉู ุนุตุจ ฺฉุงููููุดู ฺฉโุจุนุฏ (1D CNN) (`team_code_1D_CNN.py`)
ุงู ุฑูฺฉุฑุฏ ุงุฒ ฺฉ ูุนูุงุฑ ุณูุงุฑุด 1D ResNet ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ูุณุชููุงู ุฑู ุณฺฏูุงูโูุง ุฎุงู ููุงุฑ ููุจ ุจูโููุฑุงู ุฏุงุฏูโูุง ฺูุฏูุฌู ุฏููฺฏุฑุงูฺฉ ุขููุฒุด ุฏุฏู ุงุณุช:
- **ูพุดโูพุฑุฏุงุฒุด (Preprocessing):** ูุฑุชุจโุณุงุฒ ูุฌุฏุฏ ูุฏูุง ุจู ุชุฑุชุจ ุงุณุชุงูุฏุงุฑุฏ 12-ูุฏุ ูููููโุจุฑุฏุงุฑ ูุฌุฏุฏ ุจู ูุฑฺฉุงูุณ 500 ูุฑุชุฒุ ูุฑูุงูโุณุงุฒ ุจุง ุงุณุชูุงุฏู ุงุฒ ููุฑู ุงุณุชุงูุฏุงุฑุฏ (Z-score) ุจุฑุง ูุฑ ูุฏ ู ุจุฑุด/ูพุฏูฺฏ (padding/cropping) ุณฺฏูุงู ุจู ฺฉ ูพูุฌุฑู ุฒูุงู ุซุงุจุช 10 ุซุงููโุง (5000 ููููู). ููฺูู ุณู ู ุฌูุณุช ุงุฒ ูุงูโูุง ูุฏุฑ ูุฑูุงูโุณุงุฒ ูโุดููุฏ.
- **ูุนูุงุฑ:** ฺฉ ูุณุฎู ฺฉโุจุนุฏ ุงูุชุจุงุณโุดุฏู ุงุฒ ResNet-18. ุงู ูุฏู ุฏุงุฑุง ฺฉ ูุฏุงู ุฏุฑุงูุช ุงููู ูุณุน (`kernel_size=51`) ุจุฑุง ุซุจุช ูุงฺฉุฑู-ุดฺฉูโููุฌ ููุงุฑ ููุจ ุงุณุช. ูฺฺฏโูุง ุณู ู ุฌูุณุช ูุจู ุงุฒ ุฑุณุฏู ุจู ุขุฎุฑู ูุงู ฺฉุงููุงู ูุชุตู (fully connected) ุงูุญุงู (concatenate) ูโุดููุฏ. ุจุฑุง ุชูุธูโููุฏ (regularization) ุงุฒ `Dropout(p=0.5)` ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
- **ุงุณุชุฑุงุชฺ ุขููุฒุด:** ุจุง ุชุงุจุน ุฒุงู `BCEWithLogitsLoss` ุขููุฒุด ูโุจูุฏ. ูุงุชุฑุงุฒ ฺฉูุงุณโูุง ุจูโุตูุฑุช ูพูุง ูุญุงุณุจู ูโุดูุฏ ู ฺฉ ูุญุฏูุฏุช `pos_weight` ุงุนูุงู ูโฺฏุฑุฏุฏ ุชุง ุฌุฑูู ุณูฺฏู ุจุฑุง ุงุฒ ุฏุณุช ุฏุงุฏู ฺฉูุงุณ ุงููุช (ูุซุจุช) ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ. ุงุฒ ุจูููโุณุงุฒ AdamW (ุจุง ูุฑุฎ ุงุฏฺฏุฑ 1e-3) ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
- **ููุชูุฑ ุงุนุชุจุงุฑุณูุฌ:** ุชููู ุฒูุฏููฺฏุงู (Early Stopping) ุฏุงุฎู ฺฉู ุฏุฑ ุจุฑุงุจุฑ ฺฉ ูพูุดู ุงุนุชุจุงุฑุณูุฌ ุฌุฏุงฺฏุงูู (`validation_data` ฺฉู ุชูุณุท `split_data.py` ุงุฌุงุฏ ุดุฏู) ุงุฑุฒุงุจ ูโุดูุฏ. ุดุงูู ฺฉ ุจูููโุณุงุฒ ุขุณุชุงูู ุชุตููโฺฏุฑ ูพูุง (grid-search) ุงุณุช ฺฉู ุจุฑุง ุจู ุญุฏุงฺฉุซุฑ ุฑุณุงูุฏู ูุนุงุฑ F-measure ุจุฑ ุฑู ุงุญุชูุงูุงุช ุงุนุชุจุงุฑุณูุฌ ุทุฑุงุญ ุดุฏู ุงุณุช.

### ุงุณูพฺฉุชุฑูฺฏุฑุงู + EfficientNet-B0 (`team_code_spectrogram.py`)
ุงู ุฑูฺฉุฑุฏ ุณฺฏูุงูโูุง ฺฉโุจุนุฏ ููุงุฑ ููุจ ุฑุง ุจู ุชุตุงูุฑ ุฏูุจุนุฏ ุฒูุงู-ูุฑฺฉุงูุณ (Spectrogram) ุชุจุฏู ูโฺฉูุฏ ุชุง ููโุฒูุงู ูฺฺฏโูุง ููุฑููููฺฺฉ ฺฉูุชุงูโูุฏุช ู ุชุบุฑุงุช ุจููุฏูุฏุช (HRV) ุฑุง ุงุณุชุฎุฑุงุฌ ฺฉูุฏ:
- **ูพุดโูพุฑุฏุงุฒุด ู ุชุจุฏู STFT (ุทูโูฺฏุงุฑ):** ุณฺฏูุงูโูุง ุจู ูุฑฺฉุงูุณ 400 ูุฑุชุฒ ูููููโุจุฑุฏุงุฑ ูุฌุฏุฏ ุดุฏู ู ุฏุฑ ูพูุฌุฑูโูุง 10 ุซุงููโุง ุซุงุจุช ุจุฑุด ูโุฎูุฑูุฏ. ุณูพุณ ุชุจุฏู ููุฑู ุฒูุงู ฺฉูุชุงู (STFT) ุจุฑุง ูุฑ ูุฏ ูุญุงุณุจู ุดุฏูุ ุจุงุฒู ูพุฒุดฺฉ ููู (0 ุชุง 40 ูุฑุชุฒ) ุฌุฏุง ฺฏุดุชู ู ุงูุฏุงุฒู (Magnitude) ุขู ุจู ุฏุณโุจู (dB) ุชุจุฏู ูโุดูุฏ.
- **ุชููุฏ ุชุตูุฑ (Image Grid):** ฑฒ ุงุณูพฺฉุชุฑูฺฏุฑุงู ุจูโุฏุณุชโุขูุฏู ุฏุฑ ฺฉ ฺูุด ุจููู ดรณ ฺฉูุงุฑ ูู ูุฑุงุฑ ูโฺฏุฑูุฏ ุชุง ุงุฒ ุงุนูุฌุงุฌ ู ฺฉุดุฏฺฏ ุบุฑุทุจุน ูุณุจุช ุชุตูุฑ (Aspect-Ratio) ููฺฏุงู ุชุบุฑ ุงูุฏุงุฒู (Resize) ุจู 224x224 (ููุฑุฏ ูุงุฒ ูุฏูโูุง ุชุตูุฑ) ุฌููฺฏุฑ ุดูุฏ.
- **ูุนูุงุฑ ู ุขููุฒุด:** ุงุฒ ุดุจฺฉู ุงุฒโูพุดโุขููุฒุดโุฏุฏู `EfficientNet-B0` ุฏุฑ ฺฉูุงุฑ ูุงุจูุช ุฏูุช ุชุฑฺฉุจ ุฎูุฏฺฉุงุฑ ูพุงโุชูุฑฺ (AMP) ุงุณุชูุงุฏู ุดุฏู ุงุณุช ุชุง ุจุง ูุฌูุฏ ูุญุฏูุฏุช ุณุฎุชโฺฏุฑุงูู ด ฺฏฺฏุงุจุงุช VRAMุ ุจุชูุงูู Batch Size ุฑุง ุฑู 32 ูฺฏู ุฏุงุฑู. ุฏุณุชูโุจูุฏ (Classifier) ููุงุ ูฺฺฏโูุง ุชุตูุฑ ุงุณุชุฎุฑุงุฌโุดุฏู ุฑุง ุจุง ูฺฺฏโูุง ุณู (ูุฑูุงูโุดุฏู) ู ุฌูุณุช ุชุฑฺฉุจ (Concatenate) ูโฺฉูุฏ.
- **ููุชูุฑ ุงุนุชุจุงุฑุณูุฌ:** ุชููู ุฒูุฏููฺฏุงู (Early Stopping) ุชูุธู ุดุฏู ุฑู ุฏุงุฏูโูุง `validation_data`. ุฏุงุฑุง ุจูููโุณุงุฒ ุขุณุชุงูู ุชุตููโฺฏุฑ ูพูุง ุจุฑุง ุจู ุญุฏุงฺฉุซุฑ ุฑุณุงูุฏู ูุนุงุฑ F-measure (ุขุณุชุงูู ุจููู: 0.70).

## ๐ ูุชุงุฌ ุงุฑุฒุงุจ (Benchmarks)

| ูุฏู | ุงูุชุงุฒ ูุณุงุจูู (Challenge Score) | AUROC | AUPRC | ุฏูุช (Accuracy) | F-measure |
| :--- | :---: | :---: | :---: | :---: | :---: |
| ุงุฏฺฏุฑ ูุงุดู ฺฉูุงุณฺฉ | 0.629 | 0.913 | 0.611 | 0.984 | 0.611 |
| ุดุจฺฉู 1D CNN | 0.442 | 0.856 | 0.316 | 0.966 | 0.327 |
| ุงุณูพฺฉุชุฑูฺฏุฑุงู + EfficientNet-B0 | 0.379 | 0.815 | 0.202 | 0.959 | 0.265 |
